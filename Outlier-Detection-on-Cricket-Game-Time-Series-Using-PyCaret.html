<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Outlier Detection on Cricket Game Time Series Using PyCaret</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Outlier Detection on Cricket Game Time Series Using PyCaret</h1>
</header>
<section data-field="subtitle" class="p-summary">
Anomaly or Outlier detection is a technique in machine learning which identifies data points that deviate from the normal behavior of the…
</section>
<section data-field="body" class="e-content">
<section name="f485" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4497" id="4497" class="graf graf--h3 graf--leading graf--title">Outlier Detection on Cricket Game Time Series Using PyCaret</h3><figure name="5f2b" id="5f2b" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*YG_5TVsJMj0b0Cjlp-QknQ.jpeg" data-width="1200" data-height="639" data-is-featured="true" alt="A time series graph showing change in value of a random variable over time" src="https://cdn-images-1.medium.com/max/800/1*YG_5TVsJMj0b0Cjlp-QknQ.jpeg"><figcaption class="imageCaption">Time series — Image by author</figcaption></figure><p name="cabc" id="cabc" class="graf graf--p graf-after--figure">Anomaly or Outlier detection is a technique in machine learning which identifies data points that deviate from the normal behavior of the dataset. The presence of outliers indicate key events such as spike or drop in sales data of a retail product, high usage of resources in network and compute environments, etc. The anomalous data not necessarily present a problem but it may indicate a less common outcome given the whole dataset. This article explores visualizing innings in cricket games as a time series and applies PyCaret’s Isolation Forest algorithm to detect the outliers.</p><h3 name="e0b8" id="e0b8" class="graf graf--h3 graf-after--p">Motivation</h3><p name="261f" id="261f" class="graf graf--p graf-after--h3">As a sports lover, cricket lover in particular and data science practitioner, I constantly  ask myself this question — How can I apply data science / machine learning techniques to the game of Cricket? I pondered quite a bit and came up with this idea of creating a visual representation of the cricket game with all the outliers highlighted. This could be useful for coaching staffs and/or players to visualize the key data quickly during/after the game.</p><h3 name="90a8" id="90a8" class="graf graf--h3 graf-after--p">What is Cricket?</h3><div name="3286" id="3286" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://en.wikipedia.org/wiki/Cricket" data-href="https://en.wikipedia.org/wiki/Cricket" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://en.wikipedia.org/wiki/Cricket"><strong class="markup--strong markup--mixtapeEmbed-strong">Cricket - Wikipedia</strong><br><em class="markup--em markup--mixtapeEmbed-em">Cricket is a bat-and-ball game played between two teams of eleven players each on a field at the centre of which is a…</em>en.wikipedia.org</a><a href="https://en.wikipedia.org/wiki/Cricket" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="21771633e61c8ac8716e0d8b3792e682" data-thumbnail-img-id="0*HkbMFzNgB5Vk7A2v" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*HkbMFzNgB5Vk7A2v);"></a></div><h3 name="f807" id="f807" class="graf graf--h3 graf-after--mixtapeEmbed"><strong class="markup--strong markup--h3-strong">What is PyCaret?</strong></h3><p name="0186" id="0186" class="graf graf--p graf-after--h3">PyCaret is an open-source, low-code machine learning library that automates machine learning workflows.</p><div name="ac02" id="ac02" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://pycaret.org/" data-href="https://pycaret.org/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://pycaret.org/"><strong class="markup--strong markup--mixtapeEmbed-strong">Home - PyCaret</strong><br><em class="markup--em markup--mixtapeEmbed-em">With PyCaret, you don&#39;t have to leave your Notebook. Train your model, analyze it, iterate faster than ever before, and…</em>pycaret.org</a><a href="https://pycaret.org/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="52e8c14d817a429a302765bbc41a8132" data-thumbnail-img-id="0*7ulGfJ2-6nvZkCrI" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*7ulGfJ2-6nvZkCrI);"></a></div><h3 name="b076" id="b076" class="graf graf--h3 graf-after--mixtapeEmbed">Dataset</h3><p name="1b93" id="1b93" class="graf graf--p graf-after--h3">The dataset used here is available in <a href="https://www.kaggle.com/datasets/rajsengo/indian-premier-league-ipl-all-seasons" data-href="https://www.kaggle.com/datasets/rajsengo/indian-premier-league-ipl-all-seasons" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Kaggle</a>. I created this dataset by scraping public data from <a href="https://www.espncricinfo.com/" data-href="https://www.espncricinfo.com/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.espncricinfo.com/</a> and made it available under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="markup--anchor markup--p-anchor" rel="noopener noreferrer noopener" target="_blank">CC BY-NC-SA 4.0</a></p><h3 name="1491" id="1491" class="graf graf--h3 graf-after--p">Cricket Game as Time Series</h3><p name="b917" id="b917" class="graf graf--p graf-after--h3">A 20 over cricket game consists of two innings. These innings represent the batting outcome of both the teams that play the game. This can be visualized as a time series where x-axis is the number of balls in the innings (in other words instance of time) and y-axis is the number of runs scored in each delivery (value of the random variable).</p><p name="94e7" id="94e7" class="graf graf--p graf-after--p">The chart below represents a single IPL game in a time series format. This game was between Chennai Super Kings (CSK) and Mumbai Indians (MI) played on April 21, 2002 at DY Patil Stadium, Mumbai in which CSK won by 3 wickets.</p><figure name="cc07" id="cc07" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GFtarenyc4O2ZUItoKK0oQ.png" data-width="809" data-height="900" src="https://cdn-images-1.medium.com/max/800/1*GFtarenyc4O2ZUItoKK0oQ.png"><figcaption class="imageCaption">Cricket Innings as Time Series — Image by author</figcaption></figure><h3 name="7e92" id="7e92" class="graf graf--h3 graf-after--figure">What is Isolation Forest?</h3><p name="d446" id="d446" class="graf graf--p graf-after--h3">Isolation forest is an ensemble learning algorithm, effectively used in time series anomaly detection. It can be used in unsupervised setting which does not rely on prior labeling of the outliers. It is based on the fact that the anomalous data are “few and different” data points in the given dataset. In this algorithm a random sub-sample of the data is obtained from the original dataset and a decision tree is built based on random cuts in values of randomly selected features of the data. The samples that take many branches to reach the leaf node are less likely to be outliers while the samples that take shorter branches may indicate outliers.</p><p name="3e2c" id="3e2c" class="graf graf--p graf-after--p">The figure below shows how the cuts are done by the Isolation Forest algorithm. Fig (a) shows that the red point (outlier) is isolated in three random cuts where as Fig (b) shows the same process for the normal data point. Since the normal point is deep inside the data it takes many cuts to isolate that data point. The numbers on the lines represent the order of tree branching process.</p><figure name="9056" id="9056" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4bjPNbot2lRYfCYdOaciBw.png" data-width="655" data-height="351" src="https://cdn-images-1.medium.com/max/800/1*4bjPNbot2lRYfCYdOaciBw.png"><figcaption class="imageCaption">Source : <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" data-href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179</a></figcaption></figure><h3 name="daf3" id="daf3" class="graf graf--h3 graf-after--figure">Methodology</h3><p name="d5a2" id="d5a2" class="graf graf--p graf-after--h3">There are two major steps used in this exercise to identify the outliers present in the innings of a cricket game</p><p name="dfa3" id="dfa3" class="graf graf--p graf-after--p"> 1. Extract features and cluster commentary text using KMeans clustering algorithm</p><p name="f134" id="f134" class="graf graf--p graf-after--p">2. Apply PyCaret’s Isolation Forest algorithm to detect the outliers and visualize</p><p name="bf29" id="bf29" class="graf graf--p graf-after--p">Details are below;</p><figure name="76a3" id="76a3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vVcyU4zJEvRkQIJlNOqR3w.jpeg" data-width="1200" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*vVcyU4zJEvRkQIJlNOqR3w.jpeg"><figcaption class="imageCaption">Image by author</figcaption></figure><ul class="postList"><li name="d534" id="d534" class="graf graf--li graf-after--figure">As mentioned earlier, each T20 cricket game has two innings. The game starts with coin toss where the team that wins the toss chooses to bat first or bat second (bowl first)</li><li name="379d" id="379d" class="graf graf--li graf-after--li">A typical T20 game will have around 120 deliveries (divided into 20 overs with each over consists of 6 legal balls/deliveries that a bowler has to bowl). The number will go up depending on the extra deliveries that bowlers have to bowl due to illegal deliveries judged by the umpires. The number may come down if all the batsman in the batting team get out before the completion of their innings or the batting team wins with balls to spare</li><li name="5276" id="5276" class="graf graf--li graf-after--li">Each delivery/ball bowled can be viewed as a unit of time with the result of the delivery as the outcome. Hence every delivery will have many attributes associated to it like the batsman, bowler, delivery number, over number, innings, venue, legal delivery or not and many others. There will also be commentary associated to each delivery which is a textual description of the play</li><li name="b466" id="b466" class="graf graf--li graf-after--li">The goal is to pre-process this time series data, create features, identify clusters from commentary text and feed the data to PyCaret’s Isolation Forest algorithm and Visualize the outcome</li><li name="d2a6" id="d2a6" class="graf graf--li graf-after--li">Isolation Forest is an unsupervised algorithm where there are no labeled outliers available. Hence the important parameter is the contamination parameter to the Isolation Forest model which indicates the % of outliers that we expect from the given data. I have experimented between 5–15% of the overall data as outliers</li></ul><h3 name="beed" id="beed" class="graf graf--h3 graf-after--li">Results</h3><p name="f5a3" id="f5a3" class="graf graf--p graf-after--h3">Following charts are some of the examples that highlight the outliers detected by Isolation Forest algorithm. As expected the algorithm detects some of the key data points as outliers like boundaries (4s or 6s) scored, wickets, extra deliveries. Thats quite obvious. However the interesting findings here are that the algorithm also highlights some of the points that are associated with unique attributes like the examples given below. I believe these would be quite useful data points for coaches and/or players to focus on and strategize!</p><figure name="5431" id="5431" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*brzc4mEl7oCYI0d3M6gGXQ.png" data-width="809" data-height="900" alt="Cricket game time series with outliers highlighted" src="https://cdn-images-1.medium.com/max/800/1*brzc4mEl7oCYI0d3M6gGXQ.png"><figcaption class="imageCaption">Example. 1 Red dots highlight the outliers (Image by author)</figcaption></figure><figure name="4633" id="4633" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*MM9CEQYreisrzDcWtE613g.png" data-width="809" data-height="900" alt="Cricket game time series with outliers highlighted" src="https://cdn-images-1.medium.com/max/800/1*MM9CEQYreisrzDcWtE613g.png"><figcaption class="imageCaption">Example. 2 Red dots highlight the outliers (Image by author)</figcaption></figure><h4 name="920d" id="920d" class="graf graf--h4 graf-after--figure">Key Findings</h4><p name="57c7" id="57c7" class="graf graf--p graf-after--h4">The algorithm did capture most of the well know events in the game (the evens that one could remember easily) But it performed well in identifying some of the lesser known events in the game that are critical for coaches/players to use for further analysis and planning.</p><p name="fd85" id="fd85" class="graf graf--p graf-after--p">Following are the descriptions of some of well known events from the game that are highlighted as outliers (as expected).</p><blockquote name="4dce" id="4dce" class="graf graf--blockquote graf-after--p">Clear Outliers!</blockquote><pre name="67a0" id="67a0" class="graf graf--pre graf-after--blockquote">&quot;&lt;b&gt;Oh God, Knight Riders have won with four overs to spare! They needed 35 from 30 balls, and Cummins got them all in six deliveries.&lt;/b&gt; Unbelievable stuff! Cummins ends with 56 off 15 balls. Four fours and six sixes in that innings. Slower ball on a full length on fifth stump, as he went slogging over the bowler&#39;s head. A lifetime of a T20 innings there&quot;</pre><pre name="37d0" id="37d0" class="graf graf--pre graf-after--pre">&#39;&lt;strong&gt;Taken at long-on!&lt;/strong&gt; A full ball outside off has Mavi reaching out and trying to pull it to the legside, but he only manages to top-edge it. This ball went straight up for Parag to take the catch at a comfortable height and to have Chahal on the verge of a hat-trick.&#39;</pre><pre name="f34b" id="f34b" class="graf graf--pre graf-after--pre">&#39;&lt;strong&gt;Caught behind!&lt;/strong&gt; Takes the outside edge of the cover-drive does a full ball spinning away from outside off. Cummins went across and pushed at it. It leads to Chahal celebrating with a leap and a slide to take him to the jolly pose at the boundary with the elbow on the ground. The hat-trick has RR firmly on top!&#39;</pre><p name="f854" id="f854" class="graf graf--p graf-after--pre">However, following are the descriptions of some of the interesting, lesser known data points highlighted as outliers. </p><blockquote name="ca80" id="ca80" class="graf graf--blockquote graf-after--p">Hidden Outliers!</blockquote><pre name="ea05" id="ea05" class="graf graf--pre graf-after--blockquote">&#39;appeal for catch down the leg side, but it has been called a wide. Jadeja decides not to review it. There is a clear noise as the ball passes Kishan but it is not the bat. It has come off the pad&#39;</pre><pre name="2edc" id="2edc" class="graf graf--pre graf-after--pre">&#39;paddle sweep first ball, takes it from outside off, and places it fine of fine leg for four&#39;</pre><pre name="488a" id="488a" class="graf graf--pre graf-after--pre">&#39;Angling down leg on a length, misses the flick.&#39;</pre><pre name="147f" id="147f" class="graf graf--pre graf-after--pre">&quot;spears this flat and fast down the leg side, Samson dives to keep this from being five wides but doesn&#39;t collect cleanly and they take a second wide.&quot;</pre><pre name="d2db" id="d2db" class="graf graf--pre graf-after--pre">&quot;&lt;strong&gt;run-out at the keeper&#39;s end?&lt;/strong&gt; Yup, he is short of the crease. They wanted a second for once, but Rabada was sent back after they realised it wasn&#39;t possible, as he had to dive to try and get in. Not sure where they saw the second run there. Shami at third man scampered across to his right to pick the ball and throw back flat to the keeper after the ball was bowled on a back on off, with Chahar opening the bat face to beat diving to his right&quot;</pre><pre name="c69d" id="c69d" class="graf graf--pre graf-after--pre">&#39;short and wide on seventh stump, cuts straight to the point sweeper.&#39;</pre><pre name="e51e" id="e51e" class="graf graf--pre graf-after--pre">&#39;&lt;strong&gt;is that an excellent catch by Surya at long-off?&lt;/strong&gt; That was taken extremely well, but it is called no-ball for height. Oh my, everything happening here. Sams ends up bowling a high full toss on off, and Cummins swats that to long-off with his bottom hand off. Surya there was falling back while he took the catch, with his back leg very close to the rope. He ended up going outside the rope and pushed the ball back in, only to be back in and take it again. So an outstanding effort all in vain there&#39;</pre><h3 name="39bb" id="39bb" class="graf graf--h3 graf-after--pre">Conclusion</h3><ul class="postList"><li name="f51e" id="f51e" class="graf graf--li graf-after--h3">As we can observe from the visualizations, most of the key outlier events from the game have been properly identified.</li><li name="7606" id="7606" class="graf graf--li graf-after--li">However the Isolation Forest algorithm has a bias for certain data points because of the way the cuts are made as explained by <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" data-href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" class="markup--anchor markup--li-anchor" rel="noreferrer nofollow noopener noopener" target="_blank">IEEE — Extended Isolation Forest</a>. This results in occasionally identifying normal data points as outliers.</li><li name="c0ce" id="c0ce" class="graf graf--li graf-after--li">Next step is to perform similar experiment with Extended Isolation Forest algorithm as well as other outlier detection algorithms and compare the results.</li></ul><h3 name="4fe3" id="4fe3" class="graf graf--h3 graf-after--li">Source Code</h3><p name="f7ca" id="f7ca" class="graf graf--p graf-after--h3"><a href="https://www.kaggle.com/code/rajsengo/pycaret-time-series-outlier-detection-ipl-data" data-href="https://www.kaggle.com/code/rajsengo/pycaret-time-series-outlier-detection-ipl-data" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Kaggle Notebook</a></p><p name="7405" id="7405" class="graf graf--p graf-after--p"><a href="https://github.com/sengorajkumar/timeseries-outlier-detection" data-href="https://github.com/sengorajkumar/timeseries-outlier-detection" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Github</a></p><h3 name="7ba6" id="7ba6" class="graf graf--h3 graf-after--p">References</h3><p name="05a2" id="05a2" class="graf graf--p graf-after--h3">My sincere thanks to authors of the below articles/paper for the wonderful knowledge sharing.</p><ul class="postList"><li name="c2b2" id="c2b2" class="graf graf--li graf-after--p"><a href="https://towardsdatascience.com/time-series-anomaly-detection-with-pycaret-706a6e2b2427" data-href="https://towardsdatascience.com/time-series-anomaly-detection-with-pycaret-706a6e2b2427" class="markup--anchor markup--li-anchor" rel="noreferrer nofollow noopener" target="_blank">Time Series Anomaly Detection with PyCaret</a></li><li name="6789" id="6789" class="graf graf--li graf-after--li"><a href="https://www.analyticsvidhya.com/blog/2021/07/anomaly-detection-using-isolation-forest-a-complete-guide/" data-href="https://www.analyticsvidhya.com/blog/2021/07/anomaly-detection-using-isolation-forest-a-complete-guide/" class="markup--anchor markup--li-anchor" rel="noreferrer nofollow noopener" target="_blank">Anomaly detection using Isolation Forest — A Complete Guide</a></li><li name="d210" id="d210" class="graf graf--li graf-after--li"><a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" data-href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=8888179" class="markup--anchor markup--li-anchor" rel="noreferrer nofollow noopener" target="_blank">IEEE — Extended Isolation Forest</a></li></ul><p name="9e68" id="9e68" class="graf graf--p graf--empty graf-after--li graf--trailing"><br></p></div></div></section>
</section>
</article></body></html>